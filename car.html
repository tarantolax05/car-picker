<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Dettaglio Auto</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
    background: radial-gradient(circle at 20% 20%, #0d1b2a, #08141f 60%, #050c14);
    background-size: 200% 200%;
    animation: bgShift 15s ease-in-out infinite;
    color: #fff;
    font-family: 'Poppins', sans-serif;
    margin:0;
    padding:20px;
    overflow-x:hidden;
}

@keyframes bgShift {
    0% { background-position: 0% 0%; filter: brightness(1); }
    50% { background-position: 100% 100%; filter: brightness(1.07); }
    100% { background-position: 0% 0%; filter: brightness(1); }
}

/* --- CARD PRINCIPALE --- */
.container {
    max-width: 900px;
    margin: 48px auto;
    padding: 28px;
    background: rgba(255,255,255,0.08);
    backdrop-filter: blur(28px) saturate(180%);
    border-radius: 26px;
    border: 1px solid rgba(255,255,255,0.16);
    box-shadow:
        inset 0 0 40px rgba(255,255,255,0.05),
        0 25px 60px rgba(0,0,0,0.55),
        0 0 22px rgba(0,180,255,0.15);
    opacity: 0;
    transform: translateY(28px) scale(.95);
    animation: panelEnter 1s cubic-bezier(.16,.84,.44,1) forwards;
}

@keyframes panelEnter {
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

/* --- LAYOUT --- */
.top { 
    display:flex; 
    gap:28px; 
    align-items:flex-start; 
    flex-wrap:wrap; 
}

/* --- IMMAGINE AUTO CON EFFETTI 3D PI√ô FORTI --- */
.img-wrap {
    flex: 1 1 340px;
    position: relative;
    border-radius: 20px;
    overflow: hidden;
    transform-style: preserve-3d;
    transition: transform .55s cubic-bezier(.22,.61,.36,1), filter .35s ease;
    filter: drop-shadow(0 6px 28px rgba(0,0,0,0.55));
}

.img-wrap:hover {
    transform: perspective(1000px) rotateY(10deg) rotateX(4deg) scale(1.06);
    filter: drop-shadow(0 10px 40px rgba(0,180,255,0.35));
}

.img-wrap img { 
    width:100%; 
    object-fit: cover;
    border-radius: 20px;
}

/* --- SHINE MIGLIORATO --- */
.img-wrap::after {
    content:"";
    position:absolute;
    top:-120%;
    left:-180%;
    width:330%;
    height:330%;
    background: linear-gradient(
        130deg,
        transparent 65%,
        rgba(255,255,255,0.22),
        transparent 85%
    );
    animation: imgShine 4.5s ease-in-out infinite;
    pointer-events:none;
    opacity:.85;
}

@keyframes imgShine {
    0% { transform: translate(-60%,-70%) rotate(18deg); }
    50% { transform: translate(70%,70%) rotate(18deg); }
    100% { transform: translate(-60%,-70%) rotate(18deg); }
}

/* --- INFO PANEL --- */
.info { 
    flex: 1 1 320px;
    animation: contentFade .9s ease forwards .2s;
    transform: translateY(16px);
    opacity:0;
}

@keyframes contentFade {
    to { opacity:1; transform: translateY(0); }
}

/* --- TITOLI E TESTI --- */
.info h1 { 
    margin:0 0 16px 0; 
    font-size: 2.2rem; 
    font-weight: 700;
    text-shadow:
        0 0 22px rgba(0,180,255,0.55),
        0 0 12px rgba(0,180,255,0.35);
    letter-spacing: .5px;
}

.info p { 
    margin:10px 0;
    opacity:0.95; 
    font-size: 1.1rem;
    line-height: 1.55;
}

/* --- BOTTONE TORNA INDIETRO --- */
.back { 
    display:inline-block;
    margin-top:18px; 
    padding:14px 26px; 
    border-radius:14px;
    background: rgba(255,255,255,0.10);
    border: 1px solid rgba(255,255,255,0.18);
    font-weight:600;
    text-decoration:none;
    color:#fff; 
    position:relative;
    overflow:hidden;
    letter-spacing:.35px;
    transition: all .35s ease;
    backdrop-filter: blur(6px);
}

.back::before {
    content:"";
    position:absolute;
    top:0;
    left:-100%;
    width:50%;
    height:100%;
    background: linear-gradient(120deg, transparent, rgba(255,255,255,0.55), transparent);
    transition: .65s ease;
}

.back:hover::before {
    left:140%;
}

.back:hover {
    transform: translateY(-5px) scale(1.04);
    box-shadow:
        0 14px 40px rgba(0,160,255,0.35),
        0 0 14px rgba(0,160,255,0.4);
}

/* --- LINK WIKI UPGRADE --- */
.wiki-link {
    margin-top: 10px;
    color: #96eaff;
    text-decoration: none;
    font-weight:600;
    position:relative;
    transition: .30s ease;
}

.wiki-link:hover {
    color: #d0faff;
    transform: scale(1.07) translateX(4px);
    text-shadow: 0 0 16px rgba(110,220,255,0.9);
}

/* --- TARGA --- */
.targa img {
    transition: transform .4s ease, filter .4s ease;
}

.targa img:hover {
    transform: scale(1.06);
    filter: drop-shadow(0 0 12px rgba(0,180,255,0.4));
}

  </style>
</head>
<body>
  <div class="container" id="detailContainer">
    <a class="back" href="home.html">‚Üê Torna al Garage</a>
    <div id="detailContent"></div>
  </div>

  <script>
    function getQueryParam(name) {
      const params = new URLSearchParams(window.location.search);
      return params.get(name);
    }

    function renderDetail(car) {
        const target = document.getElementById('detailContent');
        if (!car) {
            target.innerHTML = '<p>Auto non trovata.</p>';
            return;
        }

        // Costruisce automaticamente il percorso dell'immagine targa 3D
        const plateImg = `images/${car.model}_plate.jpg`;

        target.innerHTML = `
            <div class="top">
                <div class="img-wrap">
                    <img src="${car.imageFront}" alt="${car.brand} ${car.model}" onerror="this.src='images/placeholder.jpg'">
                </div>
                <div class="info">
                    <h1>${car.brand} ${car.model}</h1>
                    <p><strong>Posti:</strong> ${car.seats}</p>
                    <p><strong>Nazionalit√† marchio:</strong> ${car.nationality || '‚Äî'}</p><br>
                    <div class="targa">
                        <strong>Targa:</strong><br>
                        <img src="${plateImg}" alt="targa ${car.model}" style="width:200px; margin-top:8px; border-radius:8px;" onerror="this.style.opacity=0.3">
                    </div>
                    <p><strong>Proprietario:</strong> ${car.owner}</p>
                    <p><strong>Per saperne di pi√π sull'auto</strong></p>
                    <a href="${car.wiki}" target="_blank" class="wiki-link">Vai alla pagina Wikipedia ‚Üó</a>
                </div>
            </div>
        `;
    }

    document.addEventListener('DOMContentLoaded', () => {
      const id = getQueryParam('id');
      let carsData = [];

      try {
        const raw = localStorage.getItem('cars_data');
        if (raw) carsData = JSON.parse(raw);
      } catch (e) {
        console.error('Errore parsing cars_data dal localStorage', e);
      }

      if (!carsData || carsData.length === 0) {
        // ATTENZIONE: sostituisci/aggiorna questi fallback se necessario
        carsData = [
          { id:1, brand:"Renault", model:"Clio", plate:"EN 883 ET", seats:5, flag:"üá´üá∑", imageFront:"images/Clio_front.jpg", imageRear:"images/Clio_rear.jpg", logo:"logos/Renault.jpg", nationality:"Francia", owner: "Filippo", wiki: "https://it.wikipedia.org/wiki/Renault_Clio_III" },
          { id:2, brand:"Opel", model:"Corsa", plate:"FA 702 KG", seats:5, flag:"üá©üá™", imageFront:"images/Corsa_front.jpg", imageRear:"images/Corsa_rear.jpg", logo:"logos/Opel.jpg", nationality:"Germania", owner: "Luca", wiki: "https://it.wikipedia.org/wiki/Opel_Corsa_E" },
          { id:3, brand:"Volkswagen", model:"Polo", plate:"DN 482 KN", seats:5, flag:"üá©üá™", imageFront:"images/Polo_front.jpg", imageRear:"images/Polo_rear.jpg", logo:"logos/Volkswagen.jpg", nationality:"Germania", owner: "Daniele", wiki: "https://it.wikipedia.org/wiki/Volkswagen_Polo_IV" },
          { id:4, brand:"Fiat", model:"500", plate:"EC 730 CE", seats:4, flag:"üáÆüáπ", imageFront:"images/500_front.jpg", imageRear:"images/500_rear.jpg", logo:"logos/Fiat.jpg", nationality:"Italia", owner: "Melany", wiki: "https://it.wikipedia.org/wiki/Fiat_500_(2007)" }
        ];
      }

      const car = carsData.find(c => String(c.id) === String(id));
      renderDetail(car);
    });
  </script>
  <script>
    document.addEventListener("mousemove", e => {
        const x = (window.innerWidth / 2 - e.clientX) / 90;
        const y = (window.innerHeight / 2 - e.clientY) / 90;
        document.body.style.setProperty("--tiltY", x + "deg");
        document.body.style.setProperty("--tiltX", -y + "deg");
    });
</script>
</body>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const link = document.querySelector('.wiki-link');
    if (!link) return;

    // Crea popup
    const previewBox = document.createElement('div');
    previewBox.style.position = 'absolute';
    previewBox.style.padding = '12px';
    previewBox.style.background = 'rgba(0,0,0,0.85)';
    previewBox.style.borderRadius = '10px';
    previewBox.style.color = 'white';
    previewBox.style.width = '280px';
    previewBox.style.fontSize = '0.9rem';
    previewBox.style.boxShadow = '0 4px 20px rgba(0,0,0,0.5)';
    previewBox.style.display = 'none';
    previewBox.style.zIndex = '999';
    document.body.appendChild(previewBox);

    link.addEventListener('mouseenter', async (e) => {
      const url = link.href;
      const title = decodeURIComponent(url.split('/wiki/')[1]);
      if (!title) return;

      try {
        const res = await fetch(`https://it.wikipedia.org/api/rest_v1/page/summary/${title}`);
        const data = await res.json();
        previewBox.innerHTML = `
          <strong>${data.title}</strong><br>
          <p style="margin-top:4px;">${data.extract ? data.extract.slice(0, 180) + '...' : 'Anteprima non disponibile.'}</p>
        `;
        previewBox.style.top = (e.pageY + 12) + 'px';
        previewBox.style.left = (e.pageX + 12) + 'px';
        previewBox.style.display = 'block';
      } catch (err) {
        previewBox.innerHTML = '<em>Anteprima non disponibile.</em>';
        previewBox.style.display = 'block';
      }
    });

    link.addEventListener('mousemove', (e) => {
      previewBox.style.top = (e.pageY + 12) + 'px';
      previewBox.style.left = (e.pageX + 12) + 'px';
    });

    link.addEventListener('mouseleave', () => {
      previewBox.style.display = 'none';
    });
  });
</script>

</html>
