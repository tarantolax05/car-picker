<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login - Garage</title>

  <!-- Usa lo stesso foglio di stile principale -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet" />

  <style>
    @keyframes fadeIn { from { opacity: 0; transform: translateY(15px);} to { opacity: 1; transform: translateY(0);} }
    @keyframes float { from { transform: translateY(0px) translateX(0px) rotate(0deg); } to { transform: translateY(30px) translateX(20px) rotate(10deg); } }
    @keyframes shake {
      10%, 90% { transform: translateX(-1px); }
      20%, 80% { transform: translateX(2px); }
      30%, 50%, 70% { transform: translateX(-4px); }
      40%, 60% { transform: translateX(4px); }
    }

    html, body { height: 100%; margin: 0; }
    body {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      background: radial-gradient(circle at 25% 25%, rgba(15,98,254,0.15), #121212 70%);
      overflow: hidden;
      font-family: 'Poppins', sans-serif;
      color: #fff;
    }

    .login-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.8s ease-out;
      position: relative;
      width: 100%;
      padding: 20px;
      box-sizing: border-box;
    }

    .glass-background {
      position: absolute;
      top: -30%;
      left: -30%;
      width: 160%;
      height: 160%;
      background: radial-gradient(circle at 50% 50%, rgba(255,255,255,0.09), transparent 70%);
      filter: blur(80px);
      animation: float 8s ease-in-out infinite alternate;
      z-index: 0;
      pointer-events: none;
    }

    .login-box {
      position: relative;
      z-index: 1;
      background: rgba(255, 255, 255, 0.12);
      backdrop-filter: blur(12px) saturate(150%);
      border-radius: 18px;
      padding: 45px 50px;
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.16);
      box-shadow: 0 4px 25px rgba(0, 0, 0, 0.35);
      width: 320px; 
      max-width: calc(100% - 40px);
    }

    .login-box h1 {
      font-size: 1.9rem;
      font-weight: 600;
      color: #fff;
      margin-bottom: 28px; /* padding originale */
      text-shadow: 0 0 10px rgba(255,255,255,0.10);
    }

    .login-box input {
      width: 100%;
      padding: 13px;
      margin: 10px 0;
      border: none;
      outline: none;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.15);
      color: #fff;
      font-size: 16px;
      text-align: center;
      transition: background 0.25s ease, box-shadow 0.25s ease, transform 0.15s ease;
      box-sizing: border-box;
    }

    .login-box input::placeholder {
      color: rgba(255,255,255,0.6); 
    }

    .login-box input:focus {
      background: rgba(15, 98, 254, 0.15);
      box-shadow: 0 0 15px rgba(15,98,254,0.23);
    }

    .btn-login { margin-top: 20px; width: 100%; }

    .error {
      margin-top: 12px;
      color: #ffb3b3;
      background: rgba(255, 50, 50, 0.06);
      border: 1px solid rgba(255,50,50,0.12);
      padding: 8px 12px;
      border-radius: 8px;
      display: none;
      font-weight: 600;
    }

    .error.show {
      display: block;
      animation: shake 420ms ease;
    }

    .footer-text {
      margin-top: 18px;
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.51);
    }

    @media (max-width: 420px) {
      .login-box { padding: 45px 50px; width: 320px; max-width: 92%; }
      .login-box h1 { font-size: 1.5rem; }
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    /* Loader futuristico e fluido */
    #loader {
      display: none;
      width: 60px;
      height: 60px;
      margin: 25px auto 0;
      position: relative;
      perspective: 120px;
      animation: pulseGlow 2.8s ease-in-out infinite alternate;
    }

    #loader::before, #loader::after {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: 50%;
      border: 3px solid transparent;
      box-shadow: 0 0 12px rgba(15,98,254,0.4);
    }

    #loader::before {
      border-top-color: #0f62fe;
      border-right-color: #6fa8ff;
      animation: spin3D 1.6s cubic-bezier(0.55, 0.2, 0.3, 0.9) infinite;
    }

    #loader::after {
      border-bottom-color: #0f62fe;
      border-left-color: #6fa8ff;
      animation: spin3DReverse 1.8s cubic-bezier(0.55, 0.2, 0.3, 0.9) infinite;
      opacity: 0.8;
    }

    @keyframes spin3D {
      0%   { transform: rotateX(0deg) rotateY(0deg) rotateZ(0deg); }
      100% { transform: rotateX(360deg) rotateY(360deg) rotateZ(360deg); }
    }

    @keyframes spin3DReverse {
      0%   { transform: rotateX(360deg) rotateY(0deg) rotateZ(0deg); }
      100% { transform: rotateX(0deg) rotateY(360deg) rotateZ(360deg); }
    }
    @keyframes pulseGlow {
      0% { filter: drop-shadow(0 0 4px rgba(15,98,254,0.5)); }
      100% { filter: drop-shadow(0 0 14px rgba(15,98,254,0.8)); }
    }
    
    /* Glow pulsante attorno al loader */
    #loader::after {
      box-shadow: 0 0 25px rgba(15,98,254,0.6), inset 0 0 15px rgba(15,98,254,0.5);
    }

    .toggle-password {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255,255,255,0.12);
      backdrop-filter: blur(6px);
      border: 1px solid rgba(255,255,255,0.25);
      color: #fff;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.25s ease;
    }

    .toggle-password:hover {
      background: rgba(255,255,255,0.2);
      transform: translateY(-50%) scale(1.1);
      box-shadow: 0 0 8px rgba(15,98,254,0.4);
    }

    .toggle-password:active {
      transform: translateY(-50%) scale(0.95);
    }
  </style>
</head>

<body>
  <div class="login-container" role="main">
    <div class="glass-background" aria-hidden="true"></div>

    <div class="login-box"> 
      <h1>Accedi al Garage</h1> 
      <input type="text" id="username" placeholder="Nome utente" autocomplete="username" /> 
      <div class="input-wrapper"> 
        <input type="password" id="password" placeholder="Password" autocomplete="current-password" /> 
        <button type="button" class="toggle-password" id="togglePassword"><i class="fa-solid fa-eye"></i></button> 
      </div> 
      <button class="btn btn-login" id="loginBtn" type="button">Entra</button> 
      <div id="loader"></div> 
      <div id="errorMsg" class="error">Username o password errati.</div> 
      <p class="footer-text">Benvenuto nel garage dei Donatelli. Accedi con le credenziali fornite da Tarantolax.</p> 
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // leggi lo username dinamico ogni volta che la pagina viene caricata
      const SAVED_USER = localStorage.getItem('saved_username') || 'ADMIN2020';
      const LOGIN_PASS = 'dntl00i';

      const usernameEl = document.getElementById('username');
      const passwordEl = document.getElementById('password');
      const loginBtn = document.getElementById('loginBtn');
      const errorMsg = document.getElementById('errorMsg');
      const loader = document.getElementById('loader');
      const togglePasswordBtn = document.getElementById('togglePassword');

      console.log('Login page loaded. accepted username =', SAVED_USER);

      function showError(text){
        errorMsg.textContent = text || 'Username o password errati.';
        errorMsg.classList.remove('show');
        void errorMsg.offsetWidth;
        errorMsg.classList.add('show');
      }
      function clearError(){ errorMsg.classList.remove('show'); }

      function handleLogin(){
        // leggi di nuovo saved_username al momento del login (piÃ¹ robusto)
        const currentSaved = localStorage.getItem('saved_username') || 'ADMIN2020';
        const user = usernameEl.value.trim();
        const pass = passwordEl.value.trim();
        console.log('Try login with', user, pass ? '***' : '(empty)');
        if(user === currentSaved && pass === LOGIN_PASS){
          loginBtn.style.display = 'none';
          if(loader) loader.style.display = 'block';
          try{ localStorage.setItem('logged_user', user); } catch(e){}
          setTimeout(()=> window.location.href = 'home.html', 700);
        } else {
          showError();
        }
      }

      loginBtn.addEventListener('click', handleLogin);
      document.addEventListener('keydown', (e)=> {
        if(e.key === 'Enter' && (document.activeElement === usernameEl || document.activeElement === passwordEl)) handleLogin();
      });

      usernameEl.addEventListener('input', clearError);
      passwordEl.addEventListener('input', clearError);

      if(togglePasswordBtn && passwordEl){
        togglePasswordBtn.addEventListener('click', ()=>{
          const isHidden = passwordEl.type === 'password';
          passwordEl.type = isHidden ? 'text' : 'password';
          togglePasswordBtn.innerHTML = isHidden ? 'ðŸ‘' : 'ðŸ™ˆ';
          togglePasswordBtn.style.transform = 'scale(1.15)';
          setTimeout(()=> togglePasswordBtn.style.transform = '', 150);
        });
      }

      // prefill username field to help user
      usernameEl.value = SAVED_USER;
      // also show small hint (optional)
      const hint = document.getElementById('savedHint');
      if(hint) hint.textContent = `Accesso con: ${SAVED_USER}`;
    });
  </script>


</body>
</html>
